<!--
    Esta página requiere atención:
    - Un diseño propio
-->

<div class="container">
    <p class="display-1">{{ inmueble.nombre }}</p>
    <hr>
    <p class="display-3">{{ inmueble.descripcion }}</p>
    <hr>
    <p class="h5">Consumo Inmueble: {{ inmueble.filename1 }}</p>
    <hr>
    <p class="h5">Consumo Inmueble Parcial: {{ inmueble.filename2 }}</p>
    <hr>

    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <div class="col-md-12">{{ inmueble.unificar_consumos.grafica_inmueble|safe }}</div>



    {% if user.is_authenticated %}
        <a class="btn btn-primary"
           href="{% url 'forecasting:edit_inmueble' username=inmueble.user.username pk=inmueble.pk %}">Modificar
            inmueble</a>
        <a class="btn btn-primary"
           href="{% url 'forecasting:delete_inmueble' username=inmueble.user.username pk=inmueble.pk %}">Eliminar
            inmueble</a>
        <a class="btn btn-secondary"
           href="{% url 'forecasting:for_user_inmuebles' username=inmueble.user.username %}">Volver al listado</a>
    {% endif %}

    <p>Hello</p>
    <!-- Listado de las predicciones que existen para este inmueble -->
    <p class="display-3">Predicciones sobre este inmueble:</p>
    <hr>
    {% for modeloconsumo in inmueble.modeloconsumo_set.all %}
        <p>Dentro del primer for</p>
        {% for prediccion in modeloconsumo.prediccionconsumo_set.all %}
            <li class="media col-4 mt-2 mb-2">
                <img class="mr-3" src="" alt="CSV file icon">
                <div class="media-body">
                    <h5 class="mt-0 mb-1">{{ prediccion.titulo }}</h5>
                    <h6 class="mt-0 mb-1 text-muted">Creado: {{ prediccion.created_at }}</h6>
                    <a href="{% url 'forecasting:single_prediccionconsumo' pk=prediccion.pk %}" class="card-link">Consultar predicción</a>
                </div>
            </li>
        {% endfor %}
    {% endfor %}
    <p>Hola</p>


    <!-- Listado de las predicciones que existen para este inmueble. Versión de ventanas modales -->
    <p class="display-3">Listado de las predicciones que existen para este inmueble. Versión de ventanas modales</p>
    {% for modeloconsumo in inmueble.modeloconsumo_set.all %}
        <ul class="list-unstyled row justify-content-between">>
        {% for prediccion in modeloconsumo.prediccionconsumo_set.all %}
            {% include "forecasting/_prediccion_inmueble_list_item.html" %}
        {% endfor %}
        </ul>
    {% endfor %}


    <!-- Listado de los costes del consumo aplicando las tarifas creadas por el usuario -->
    <p class="display-3">Costes según las tarifas del usuario:</p>
    <p>Primero</p>
    <p>{{ inmueble.unificar_consumos.costes_tarifas_usuario }}</p>
    <p>Segundo</p>
    <p>{{ inmueble.unificar_consumos.costes_tarifas_usuario.0 }}</p>
    <p>Tercero</p>
    <p>{{ inmueble.unificar_consumos.costes_tarifas_usuario.0.Tarifa }}</p>
    <p>Cuarto</p>
    <p>{{ inmueble.unificar_consumos.costes_tarifas_usuario.0.Coste }}</p>


    <!-- PRUEBA, listado -->
    <p>Tarifa 1:</p>
    {% if inmueble.unificar_consumos.costes_tarifas_usuario.0 %}
        <p>Nombre de la Tarifa Eléctrica: {{ inmueble.unificar_consumos.costes_tarifas_usuario.0.Tarifa }}</p>
        <p>Coste según Tarifa: {{ inmueble.unificar_consumos.costes_tarifas_usuario.0.Coste }}</p>
    {% endif %}

    <p>Tarifa 2:</p>
    {% if inmueble.unificar_consumos.costes_tarifas_usuario.1 %}
        <p>{{ inmueble.unificar_consumos.costes_tarifas_usuario.0.Tarifa }}</p>
        <p>{{ inmueble.unificar_consumos.costes_tarifas_usuario.0.Coste }}</p>
    {% endif %}


    <!-- Listado de los Costes de un Inmueble a  partir de una Tarifa Eléctrica -->
    <p>Listado de Costes:</p>
    <ul class="list-unstyled row justify-content-between">
    {% for costeinmueblete in inmueble.costeinmueblete_set.all %}
        {% include "forecasting/_costeinmueble_tarifaelectrica_list_item.html" %}
    {% endfor %}
    </ul>


    <!-- Análisis de los costes del Inmueble para las tarifas qe hay -->
    <ul class="row align-items-start list-unstyled">

        <!-- Primera Columna: Tarifas Personalizadas -->
        <li class="col-4 justify-content-around bg-danger">
            <ul class="row list-unstyled justify-content-center">
                <!-- Título -->
                <li class="media my-2 border-bottom border-dark">
					<p class="h4">Tarifas Personalizadas:</p>
				</li>
                <!-- items -->
                {% if inmueble.costeinmueblete_set.exists %}
                    {% for costeinmueblete in inmueble.costeinmueblete_set.all %}
                        {% include "forecasting/_costeinmueble_tarifaelectrica_list_item.html" %}
                    {% endfor %}
                {% else %}
                    <p class="h4 text-muted">Crea alguna tarifa para mostrar aquí su coste.</p>
                {% endif %}
            </ul>
        </li>

        <!-- Segunda Columna: Mercado Regulado -->
        <li class="col-4 justify-content-around bg-warning">
            <ul class="row list-unstyled justify-content-center">
                <!-- Título -->
                <li class="media my-2 border-bottom border-dark">
					<p class="h4">Mercado Regulado:</p>
				</li>
                <!-- items -->

            </ul>
        </li>

        <!-- Tercera Columna: Mercado Libre -->
        <li class="col-4 justify-content-around bg-success">
            <ul class="row list-unstyled justify-content-center">
                <!-- Título -->
                <li class="media my-2 border-bottom border-dark">
					<p class="h4">Mercado Libre:</p>
				</li>
                <!-- items -->

            </ul>
        </li>


    </ul>


</div>
